{% extends "base.html" %} {% block content %} 
{% load render_table from django_tables2 %}

<div class="container">
  <main role="main" class="container">
    <div class="starter-template">
      <!-- <h1>Pandemic Visualiser Homepage</h1> -->

      <div class="d-flex flex-column">
        <div class="d-flex flex-row justify-content-center">
          <canvas width="350" height="350" id="confirmed_chart"></canvas>
          <canvas width="350" height="350" id="active_chart"></canvas>
        </div>
        <div class="d-flex flex-row justify-content-center">
          <canvas width="350" height="350" id="recovered_chart"></canvas>
          <canvas width="350" height="350" id="deceased_chart"></canvas>
        </div>
      </div>

      <!-- <div class="d-flex">
        <div
          class="d-flex flex-column justify-content-center align-items-center"
        >
          <div style="background-color: aqua;" >List of Hospitals</div>
          <div style="width: 500px; height: 500px; overflow-y: scroll">
            {% render_table hospitals_list %}
          </div>
        </div>

        <div
          class="d-flex flex-column justify-content-center align-items-center"
        >
          <div>Covid Care Centers</div>
          <div style="width: 500px; height: 500px; overflow-y: scroll">
            {% render_table care_center_list %}
          </div>
        </div>
      </div>

      <div class="d-flex">
        <div class="d-flex flex-column">
          <canvas width="300" height="300" id="pie_chart"></canvas>
        </div>

        <div class="d-flex flex-column">
          <canvas width="300" height="300" id="vaccine_chart"></canvas>
        </div>
      </div> -->

      <script>
        const covid_positive_labels = "{{covid_positive.labels|safe}}".split(
          ","
        );
        const covid_positive_data_set = "{{covid_positive.data|safe}}";

        const deceased_labels = "{{deceased.labels|safe}}".split(",");
        const deceased_data_set = "{{deceased.data|safe}}";

        const recovered_labels = "{{recovered.labels|safe}}".split(",");
        const recovered_data_set = "{{recovered.data|safe}}";

        const active_labels = "{{active.labels|safe}}".split(",");
        const active_data_set = "{{active.data|safe}}";

        const pie_labels = "{{age_data.labels|safe}}".split(",");
        const pie_data_set = "{{age_data.data|safe}}".split(",");

        const vaccine_labels = "{{vaccine_data.labels|safe}}".split(",");
        const vaccine_data_set = "{{vaccine_data.data|safe}}".split(",");

        const covid_positive_data = {
          labels: covid_positive_labels,
          datasets: [
            {
              label: "CONFIRMED",
              backgroundColor: "red",
              borderColor: "red",
              data: covid_positive_data_set,
              spanGaps: true,
            },
          ],
        };

        const covid_positive_config = {
          type: "line",
          data: covid_positive_data,
          options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
              subtitle: {
                display: true,
                text: "{{covid_positive.sum|safe}}",
              },
              legend: { labels: { font: { size: 14 } } },
            },
            scales: { y: { display: true }, x: { display: false } },
          },
        };
        const active_data = {
          labels: active_labels,
          datasets: [
            {
              label: "ACTIVE",
              backgroundColor: "orange",
              borderColor: "orange",
              data: active_data_set,
              spanGaps: true,
            },
          ],
        };

        const active_config = {
          type: "line",
          data: active_data,
          options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
              subtitle: {
                display: true,
                text: "{{active.sum|safe}}",
              },
              legend: { labels: { font: { size: 14 } } },
            },
            scales: { y: { display: true }, x: { display: false } },
          },
        };
        const recovered_data = {
          labels: recovered_labels,
          datasets: [
            {
              label: "RECOVERED",
              backgroundColor: "green",
              borderColor: "green",
              data: recovered_data_set,
              spanGaps: true,
            },
          ],
        };

        const recovered_config = {
          type: "line",
          data: recovered_data,
          options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
              subtitle: {
                display: true,
                text: "{{recovered.sum|safe}}",
              },
              legend: { labels: { font: { size: 14 } } },
            },
            scales: { y: { display: true }, x: { display: false } },
          },
        };
        const deceased_data = {
          labels: deceased_labels,
          datasets: [
            {
              label: "DECEASED",
              backgroundColor: "grey",
              borderColor: "grey",
              data: deceased_data_set,
              spanGaps: true,
            },
          ],
        };

        const deceased_config = {
          type: "line",
          data: deceased_data,
          options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
              subtitle: {
                display: true,
                text: "{{deceased.sum|safe}}",
              },
              legend: { labels: { font: { size: 14 } } },
            },
            scales: { y: { display: true }, x: { display: false } },
          },
        };

        const pie_data = {
          labels: pie_labels,
          datasets: [
            {
              data: pie_data_set,
              backgroundColor: [
                "rgb(255, 99, 132)",
                "rgb(54, 162, 235)",
                "rgb(255, 205, 86)",
                "rgb(75, 192, 192)",
              ],
            },
          ],
        };

        const vaccine_data = {
          labels: vaccine_labels,
          datasets: [
            {
              // label: "My First Dataset",
              data: vaccine_data_set,
              backgroundColor: [
                "rgb(255, 99, 132)",
                "rgb(54, 162, 235)",
                "rgb(255, 205, 86)",
                "rgb(75, 192, 192)",
                "rgb(153, 102, 255)",
              ],
            },
          ],
        };

        const pie_config = {
          type: "pie",
          data: pie_data,
          options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "top",
              },
              title: {
                display: true,
                text: "Age Wise Distribution of Covid Patients",
              },
            },
          },
        };

        const vaccine_config = {
          type: "bar",
          data: vaccine_data,
          options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "top",
                display: false,
              },
              title: {
                display: true,
                text: "Vaccination Coverage",
              },
            },
          },
        };
      </script>

      <script>
        const confirmed_chart = new Chart(
          document.getElementById("confirmed_chart"),
          covid_positive_config
        );
        const active_chart = new Chart(
          document.getElementById("active_chart"),
          active_config
        );
        const recovered_chart = new Chart(
          document.getElementById("recovered_chart"),
          recovered_config
        );
        const deceased_chart = new Chart(
          document.getElementById("deceased_chart"),
          deceased_config
        );

        const pie_chart = new Chart(
          document.getElementById("pie_chart"),
          pie_config
        );

        const vaccine_chart = new Chart(
          document.getElementById("vaccine_chart"),
          vaccine_config
        );
      </script>
    </div>
  </main>
</div>

{% endblock content %}
